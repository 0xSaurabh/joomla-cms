this.Form||(this.Form={}),Form.PasswordStrength=new Class({Implements:[Options,Events],options:{threshold:66,primer:"",height:5,opacity:1,bgcolor:"transparent"},element:null,fx:null,initialize:function(a,b){this.element=document.id(a),this.setOptions(b),this.options.primer&&(this.options.threshold=this.options.primer.strength());var c=this.element.getCoordinates(),d=new Element("div",{styles:{width:c.width,height:this.options.height,opacity:this.options.opacity,"background-color":this.options.bgcolor}}).inject(this.element,"after"),e=new Element("div",{styles:{width:0,height:"100%"}}).inject(d);this.fx=new Fx.Morph(e,{duration:"short",link:"cancel",unit:"%"}),this.element.addEvent("keyupandchange",this.animate.bind(this)),this.element.get("value")&&this.animate()},animate:function(){var a,b=this.element.get("value"),c=b.strength(),d=(c/this.options.threshold).round(2).limit(0,1);a=d<.5?("rgb(255, "+(255*d*2).round()+", 0)").rgbToHex():("rgb("+(255*(1-d)*2).round()+", 255, 0)").rgbToHex(),this.fx.start({width:100*d,"background-color":a}),this.fireEvent("update",[this.element,c,this.options.threshold])}}),Element.Events.keyupandchange={base:"keyup",condition:function(a){var b=this.retrieve("prev",null),c=this.get("value");return("null"==typeOf(b)||b!=c)&&(this.store("prev",c),!0)}},String.implement({strength:function(){var a=0;return this.match(/\d/)&&(a+=10),this.match(/[a-z]+/)&&(a+=26),this.match(/[A-Z]+/)&&(a+=26),this.match(/[^\da-zA-Z]/)&&(a+=33),0==a?0:(this.length*a.log()/2..log()).round()}});